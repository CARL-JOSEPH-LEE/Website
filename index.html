<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="description" content="DJCARL çš„å°å®‡å®™ï¼šå¿ƒåŠ¨ã€å¥½çœ‹ã€å¥½ç©ã€å¥½å¬ã€‚æ¥è®¤è¯†æˆ‘ã€‚" />
  <meta name="theme-color" content="#050412" />
  <title>DJCARLï½œæå¿ æ•çš„å°å®‡å®™</title>
  <link rel="icon" href="star.jpg" type="image/jpeg" />

  <style>
    :root{
      --bg0:#190312;    /* ç”œï¼šåç²‰èƒŒæ™¯ï¼ˆé»˜è®¤ï¼‰ */
      --bg1:#3a1027;
      --card: rgba(255,255,255,.10);
      --card2: rgba(255,255,255,.14);
      --stroke: rgba(255,255,255,.18);
      --txt: rgba(255,255,255,.96);
      --muted: rgba(255,255,255,.72);
      --muted2: rgba(255,255,255,.54);
      --shadow: 0 28px 90px rgba(2,2,20,.9);
      --radius: 22px;
      --radius2: 16px;

      /* mood accentï¼ˆé»˜è®¤ç”œç²‰ï¼‰ */
      --a1:#ff9ac9;
      --a2:#ff6fb1;
      --a3:#ffd3f0;

      --safeB: env(safe-area-inset-bottom, 0px);
      --safeT: env(safe-area-inset-top, 0px);
    }

    body.dark-mode{
      --bg0:#020210;
      --bg1:#050519;
      --card: rgba(255,255,255,.08);
      --card2: rgba(255,255,255,.12);
      --stroke: rgba(255,255,255,.16);
      --txt: rgba(255,255,255,.96);
      --muted: rgba(255,255,255,.7);
      --muted2: rgba(255,255,255,.55);
      --shadow: 0 32px 110px rgba(0,0,0,.95);
    }

    /* ä¸åŒå¿ƒæƒ…ï¼šç›´æ¥æ”¹èƒŒæ™¯è‰²è°ƒ */
    body[data-mood="sweet"]{
      --bg0:#190312;
      --bg1:#3a1027;
    }
    body[data-mood="cool"]{
      --bg0:#06041f;   /* æ›´ç´«æ›´å¤œ */
      --bg1:#120738;
    }
    body[data-mood="soft"]{
      --bg0:#02181b;   /* è“ç»¿è‰²è°ƒ */
      --bg1:#022b36;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      color: var(--txt);
      font-family: -apple-system, BlinkMacSystemFont, "PingFang SC","Hiragino Sans GB","Microsoft YaHei",
        "Noto Sans SC","Source Han Sans SC", system-ui, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(1200px 900px at 10% 0%, color-mix(in oklab, var(--a1) 32%, transparent) 0%, transparent 60%),
        radial-gradient(1100px 800px at 90% 0%, color-mix(in oklab, var(--a2) 36%, transparent) 0%, transparent 60%),
        radial-gradient(1300px 900px at 50% 90%, color-mix(in oklab, var(--a3) 30%, transparent) 0%, transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
      position:relative;
    }

    body::before{
      /* åŠ¨æ€æ¸å˜è½»å¾®æµåŠ¨ï¼Œè®©èƒŒæ™¯æœ‰"å‘¼å¸æ„Ÿ" */
      content:"";
      position:fixed;
      inset:-20%;
      background:
        radial-gradient(circle at 0% 0%, color-mix(in oklab, var(--a1) 14%, transparent) 0%, transparent 55%),
        radial-gradient(circle at 100% 0%, color-mix(in oklab, var(--a2) 16%, transparent) 0%, transparent 55%),
        radial-gradient(circle at 50% 100%, color-mix(in oklab, var(--a3) 14%, transparent) 0%, transparent 55%);
      mix-blend-mode: screen;
      opacity:.9;
      z-index:0;
      animation: bgFlow 22s ease-in-out infinite alternate;
      pointer-events:none;
    }

    @keyframes bgFlow{
      0%{ transform: translate3d(0,0,0) scale(1); filter:hue-rotate(0deg); }
      50%{ transform: translate3d(0,-3%,0) scale(1.03); filter:hue-rotate(12deg); }
      100%{ transform: translate3d(0,2%,0) scale(1.06); filter:hue-rotate(-8deg); }
    }

    /* çˆ±å¿ƒèƒŒæ™¯ç‰¹æ•ˆ */
    #hearts-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
      overflow: hidden;
    }

    .floating-heart {
      position: absolute;
      font-size: 24px;
      opacity: 0;
      animation: floatUpHearts 8s ease-in forwards;
      filter: drop-shadow(0 0 8px currentColor);
    }

    @keyframes floatUpHearts {
      0% {
        transform: translateY(100vh) rotate(0deg) scale(0);
        opacity: 0;
      }
      10% {
        opacity: 0.8;
        transform: translateY(90vh) rotate(0deg) scale(1);
      }
      90% {
        opacity: 0.6;
      }
      100% {
        transform: translateY(-100px) rotate(20deg) scale(0.8);
        opacity: 0;
      }
    }

    /* éŸ³é¢‘å¯è§†åŒ–ç‰¹æ•ˆ */
    #audio-visualizer {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 150px;
      z-index: 1;
      pointer-events: none;
      opacity: 0.4;
      display: none;
    }

    .visualizer-bar {
      position: absolute;
      bottom: 0;
      width: 10px;
      border-radius: 4px 4px 0 0;
      background: linear-gradient(to top, var(--a1), var(--a2));
      box-shadow: 0 0 15px var(--a1);
      transform-origin: bottom;
    }

    /* æµæ˜Ÿç‰¹æ•ˆ */
    .shooting-star {
      position: fixed;
      width: 4px;
      height: 4px;
      background: white;
      border-radius: 50%;
      box-shadow: 0 0 10px 2px white;
      z-index: 1;
      pointer-events: none;
      opacity: 0;
    }

    /* ç²’å­èƒŒæ™¯ */
    #particles-js {
      position: fixed;
      width: 100%;
      height: 100%;
      z-index: 0;
      pointer-events: none;
    }

    /* è„‰å†²å…‰ç¯ç‰¹æ•ˆ */
    .pulse-ring {
      position: absolute;
      border-radius: 50%;
      border: 2px solid;
      opacity: 0;
      animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    @keyframes pulse {
      0% {
        transform: scale(0.8);
        opacity: 0.8;
      }
      100% {
        transform: scale(1.5);
        opacity: 0;
      }
    }

    /* æŒ‰é’®å…‰æ™•ç‰¹æ•ˆ */
    .btn-glow {
      position: relative;
      overflow: hidden;
    }

    .btn-glow::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
      transition: left 0.7s;
    }

    .btn-glow:hover::before {
      left: 100%;
    }

    /* åˆ é™¤çš„å¡ç‰‡3Dç¿»è½¬æ•ˆæœä»£ç å·²ç§»é™¤ */

    /* éœ“è™¹æ–‡å­—æ•ˆæœ */
    .neon-text {
      text-shadow: 
        0 0 5px currentColor,
        0 0 10px currentColor,
        0 0 20px currentColor,
        0 0 40px currentColor;
      animation: neon-flicker 1.5s infinite alternate;
    }

    @keyframes neon-flicker {
      0%, 18%, 22%, 25%, 53%, 57%, 100% {
        text-shadow: 
          0 0 5px currentColor,
          0 0 10px currentColor,
          0 0 20px currentColor,
          0 0 40px currentColor;
      }
      20%, 24%, 55% {
        text-shadow: none;
      }
    }

    /* é­”æ³•æ˜Ÿæ˜Ÿè½¨è¿¹ */
    .magic-trail {
      position: absolute;
      width: 6px;
      height: 6px;
      background: white;
      border-radius: 50%;
      box-shadow: 0 0 10px white;
      pointer-events: none;
      z-index: 100;
    }

    /* æ¸å˜æµå½©èƒŒæ™¯å¢å¼º */
    .color-stream {
      position: fixed;
      width: 200vw;
      height: 200vh;
      background: linear-gradient(45deg, 
        var(--a1) 0%, 
        var(--a2) 25%, 
        var(--a3) 50%, 
        var(--a1) 75%, 
        var(--a2) 100%);
      opacity: 0.05;
      z-index: 0;
      animation: colorStreamFlow 30s linear infinite;
      pointer-events: none;
    }

    @keyframes colorStreamFlow {
      0% { transform: translateX(-50%) translateY(-50%) rotate(0deg); }
      100% { transform: translateX(-50%) translateY(-50%) rotate(360deg); }
    }

    /* subtle grain */
    .grain{
      position:fixed; inset:0;
      pointer-events:none;
      opacity:.1;
      mix-blend-mode: soft-light;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.85' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='160' height='160' filter='url(%23n)' opacity='.65'/%3E%3C/svg%3E");
      background-size:160px 160px;
      z-index:2;
    }

    /* è½»å¾®ç½‘æ ¼æ‰«æçº¿ï¼Œå¢åŠ ç§‘æŠ€æ„Ÿ */
    .gridlines{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:2;
      opacity:.18;
      mix-blend-mode: soft-light;
      background-image:
        linear-gradient(to right, rgba(255,255,255,.08) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(255,255,255,.06) 1px, transparent 1px);
      background-size: 80px 80px;
      animation: gridDrift 30s linear infinite;
    }
    @keyframes gridDrift{
      from{ transform: translate3d(0,0,0); }
      to{ transform: translate3d(-80px,-80px,0); }
    }

    /* èƒŒæ™¯å…‰çƒï¼Œè¥é€ æ¢¦å¹»æ„Ÿï¼ˆä¸è·Ÿéšé¼ æ ‡ï¼Œé¿å…ä¸é€‚ï¼‰ */
    .orb{
      position:fixed;
      width:260px; height:260px;
      border-radius:999px;
      filter: blur(20px);
      opacity:.22;
      mix-blend-mode:screen;
      z-index:2;
      pointer-events:none;
      transition: opacity .4s ease;
    }
    .orb1{
      top:10%; left:8%;
      background: radial-gradient(circle, color-mix(in oklab, var(--a1) 80%, transparent), transparent 70%);
      animation: orbFloat1 18s ease-in-out infinite alternate;
    }
    .orb2{
      top:26%; right:6%;
      background: radial-gradient(circle, color-mix(in oklab, var(--a2) 80%, transparent), transparent 70%);
      animation: orbFloat2 22s ease-in-out infinite alternate;
    }
    .orb3{
      bottom:10%; left:40%;
      background: radial-gradient(circle, color-mix(in oklab, var(--a3) 80%, transparent), transparent 70%);
      animation: orbFloat3 20s ease-in-out infinite alternate;
    }
    @keyframes orbFloat1{
      from{ transform: translate3d(0,0,0) scale(1); }
      to{ transform: translate3d(10px,-16px,0) scale(1.1); }
    }
    @keyframes orbFloat2{
      from{ transform: translate3d(0,0,0) scale(1); }
      to{ transform: translate3d(-14px,-10px,0) scale(1.05); }
    }
    @keyframes orbFloat3{
      from{ transform: translate3d(0,0,0) scale(1); }
      to{ transform: translate3d(0,18px,0) scale(1.15); }
    }

    a{ color:inherit; text-decoration:none; }

    .wrap{
      position:relative;
      z-index:10;
      width:min(980px, 92vw);
      margin:0 auto;
      padding: calc(22px + var(--safeT)) 0 calc(120px + var(--safeB));
      opacity:0;
      transform: translateY(20px);
      animation: pageEnter .8s cubic-bezier(.22,.8,.32,1) forwards;
      animation-delay:.12s;
    }

    @keyframes pageEnter{
      to{ opacity:1; transform: translateY(0); }
    }

    .topbar{
      position:sticky;
      top:0;
      z-index:50;
      padding: 10px 0 14px;
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      transform-origin: top;
      transition: transform .25s ease, opacity .25s ease;
    }
    .topbar-inner{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding: 10px 12px;
      border-radius: 999px;
      background: radial-gradient(circle at 0 0, rgba(255,255,255,.28), rgba(255,255,255,.07));
      border:1px solid rgba(255,255,255,.18);
      box-shadow: 0 14px 60px rgba(0,0,0,.5);
      position:relative;
      overflow:hidden;
    }

    .topbar-inner::before{
      /* é¡¶æ æµå…‰ */
      content:"";
      position:absolute;
      inset:-1px;
      background: linear-gradient(120deg, rgba(255,255,255,.7), rgba(255,255,255,0), rgba(255,255,255,.55), rgba(255,255,255,0));
      mix-blend-mode: soft-light;
      opacity:.22;
      transform: translateX(-40%);
      animation: shimmer 9s linear infinite;
      pointer-events:none;
    }
    @keyframes shimmer{
      0%{ transform: translateX(-40%); }
      50%{ transform: translateX(20%); }
      100%{ transform: translateX(60%); }
    }

    .brand{
      display:flex; align-items:center; gap:10px;
      min-width: 0;
    }

    .avatar-wrap{
      position:relative;
      width:40px; height:40px;
      flex:0 0 auto;
    }
    .avatar-ring{
      position:absolute;
      inset:-4px;
      border-radius:999px;
      background:
        conic-gradient(
          from 200deg,
          color-mix(in oklab, var(--a1) 70%, transparent),
          color-mix(in oklab, var(--a2) 70%, transparent),
          color-mix(in oklab, var(--a3) 70%, transparent),
          color-mix(in oklab, var(--a1) 70%, transparent)
        );
      opacity:.9;
      filter: blur(4px);
      animation: avatarSpin 12s linear infinite;
    }
    @keyframes avatarSpin{
      to{ transform: rotate(360deg); }
    }

    .avatar{
      position:relative;
      width:40px; height:40px; border-radius: 999px;
      border:1px solid rgba(255,255,255,.32);
      background: radial-gradient(circle at 20% 0%, rgba(255,255,255,.85), rgba(255,255,255,.05));
      overflow:hidden;
      box-shadow: 0 14px 36px rgba(0,0,0,.6);
    }
    .avatar img{ width:100%; height:100%; object-fit:cover; display:block; }

    .brand-title{
      display:flex; flex-direction:column;
      line-height:1.05;
      min-width:0;
    }
    .brand-title strong{
      font-weight:900;
      letter-spacing:.4px;
      font-size: 14px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .brand-title span{
      color: var(--muted2);
      font-size: 12px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .mood{
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .pill{
      border:1px solid rgba(255,255,255,.18);
      background: rgba(13,13,40,.7);
      color: var(--muted);
      padding: 7px 11px;
      border-radius: 999px;
      font-size: 12px;
      line-height: 1;
      user-select:none;
      position:relative;
      overflow:hidden;
      transition: transform .18s ease, background .18s ease, border-color .18s ease, color .18s ease, box-shadow .18s ease;
    }
    .pill::after{
      content:"";
      position:absolute;
      inset:0;
      background: radial-gradient(circle at 0 0, rgba(255,255,255,.35), transparent 60%);
      opacity:0;
      transition: opacity .25s ease;
      pointer-events:none;
      mix-blend-mode:soft-light;
    }
    .pill:hover{ transform: translateY(-1px); border-color: rgba(255,255,255,.28); box-shadow: 0 8px 20px rgba(0,0,0,.4); }

    body[data-mood="sweet"] #moodSweet,
    body[data-mood="cool"]  #moodCool,
    body[data-mood="soft"]  #moodSoft{
      background: linear-gradient(120deg,
        color-mix(in oklab, var(--a1) 40%, rgba(18,18,40,.9)),
        color-mix(in oklab, var(--a2) 36%, rgba(18,18,40,.95)));
      border-color: rgba(255,255,255,.85);
      color: rgba(255,255,255,.98);
    }
    body[data-mood="sweet"] #moodSweet::after,
    body[data-mood="cool"]  #moodCool::after,
    body[data-mood="soft"]  #moodSoft::after{ opacity:.55; }

    .grid{
      display:grid;
      grid-template-columns: 1.25fr .9fr;
      gap: 18px;
      margin-top: 16px;
    }
    @media (max-width: 860px){
      .grid{ grid-template-columns: 1fr; }
    }

    .card{
      position:relative;
      border-radius: var(--radius);
      overflow:hidden;
      padding:1px;
      background:
        linear-gradient(135deg,
          color-mix(in oklab, var(--a1) 26%, rgba(255,255,255,.02)),
          color-mix(in oklab, var(--a2) 20%, rgba(255,255,255,.02)),
          color-mix(in oklab, var(--a3) 18%, rgba(255,255,255,.02)));
      box-shadow: var(--shadow);
      opacity:0;
      transform: translateY(18px) scale(.98);
      transition: opacity .55s cubic-bezier(.18,.85,.35,1),
                  transform .55s cubic-bezier(.18,.85,.35,1),
                  box-shadow .25s ease;
      will-change: transform, opacity;
    }
    .card.reveal-show{
      opacity:1;
      transform: translateY(0) scale(1);
    }
    .card::before{
      content:"";
      position:absolute;
      inset:-40%;
      background:
        conic-gradient(from 220deg,
          rgba(255,255,255,.3),
          transparent,
          rgba(255,255,255,.12),
          transparent,
          rgba(255,255,255,.24));
      opacity:.16;
      filter: blur(12px);
      mix-blend-mode:screen;
      pointer-events:none;
      animation: cardGlow 18s linear infinite;
    }
    @keyframes cardGlow{
      to{ transform: rotate(360deg); }
    }
    .card .inner{
      position:relative;
      border-radius: calc(var(--radius) - 2px);
      background:
        radial-gradient(circle at 0 0, rgba(255,255,255,.10), rgba(8,8,22,.9));
      border: 1px solid rgba(255,255,255,.18);
      padding: 18px;
      backdrop-filter: blur(26px);
      -webkit-backdrop-filter: blur(26px);
      overflow:hidden;
    }

    .card:hover{
      box-shadow: 0 24px 80px rgba(0,0,0,.9);
      transform: translateY(-2px) scale(1.01);
    }

    .h1{
      font-size: clamp(27px, 3.8vw, 44px);
      line-height: 1.08;
      margin: 10px 0 10px;
      letter-spacing: .3px;
      background: linear-gradient(120deg,
        #ffffff,
        color-mix(in oklab, var(--a1) 40%, #fff),
        color-mix(in oklab, var(--a2) 36%, #fff));
      background-clip:text;
      -webkit-background-clip:text;
      color:transparent;
      text-shadow: 0 0 28px rgba(0,0,0,.7);
    }
    .sub{
      color: var(--muted);
      font-size: 14px;
      line-height: 1.6;
      margin: 0 0 14px;
    }

    .chips{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top: 10px;
    }
    .chip{
      padding: 9px 13px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(10,10,40,.8);
      color: rgba(255,255,255,.90);
      font-size: 13px;
      line-height: 1;
      position:relative;
      overflow:hidden;
      animation: chipFloat 8s ease-in-out infinite alternate;
    }
    .chip:nth-child(2){ animation-delay: .8s; }
    .chip:nth-child(3){ animation-delay: 1.4s; }
    .chip:nth-child(4){ animation-delay: 2s; }
    .chip:nth-child(5){ animation-delay: 2.6s; }
    .chip:nth-child(6){ animation-delay: 3.2s; }

    @keyframes chipFloat{
      from{ transform: translateY(0); }
      to{ transform: translateY(-4px); }
    }

    .chip::after{
      content:"";
      position:absolute;
      inset:0;
      background: radial-gradient(circle at 0 0, rgba(255,255,255,.35), transparent 60%);
      opacity:.25;
      mix-blend-mode: screen;
      pointer-events:none;
    }

    .ctaRow{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      margin-top: 16px;
    }
    .btn{
      appearance:none;
      border:1px solid rgba(255,255,255,.18);
      background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.04));
      color: rgba(255,255,255,.96);
      padding: 11px 14px;
      border-radius: 14px;
      font-weight: 700;
      font-size: 14px;
      cursor:pointer;
      transition: transform .16s ease, border-color .16s ease, box-shadow .16s ease, background .16s ease;
      user-select:none;
      display:inline-flex;
      align-items:center;
      gap:8px;
      position:relative;
      overflow:hidden;
    }
    .btn:hover{
      transform: translateY(-1px);
      border-color: rgba(255,255,255,.32);
      box-shadow: 0 13px 30px rgba(0,0,0,.6);
      background: radial-gradient(circle at 0 0, rgba(255,255,255,.18), rgba(255,255,255,.04));
    }
    .btn:active{
      transform: translateY(0px) scale(.97);
      box-shadow:none;
    }
    .btn.primary{
      border: 1px solid rgba(255,255,255,.26);
      background: linear-gradient(90deg,
        color-mix(in oklab, var(--a1) 40%, rgba(255,255,255,.12)),
        color-mix(in oklab, var(--a2) 36%, rgba(255,255,255,.1)),
        color-mix(in oklab, var(--a3) 30%, rgba(255,255,255,.08)));
      box-shadow: 0 18px 50px rgba(0,0,0,.7);
    }
    .btn.ghost{
      background: rgba(5,5,30,.7);
    }

    /* æŒ‰é’®ç²’å­ */
    .btn-particle{
      position:absolute;
      width:6px; height:6px;
      border-radius:999px;
      background: radial-gradient(circle, #fff, rgba(255,255,255,0));
      pointer-events:none;
      mix-blend-mode:screen;
      opacity:0;
      animation: particleBurst .7s ease-out forwards;
    }
    @keyframes particleBurst{
      0%{ transform: translate(0,0) scale(.6); opacity:1; }
      70%{ opacity:1; }
      100%{ transform: translate(var(--dx), var(--dy)) scale(0); opacity:0; }
    }

    .sparkle{
      width:10px; height:10px;
      border-radius:999px;
      background: radial-gradient(circle, rgba(255,255,255,.95), rgba(255,255,255,0));
      box-shadow: 0 0 22px rgba(255,255,255,.7);
      flex: 0 0 auto;
    }

    .divider{
      height:1px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.22), transparent);
      margin: 14px 0 10px;
      opacity:.8;
    }

    .mini{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding: 14px 16px;
      background: linear-gradient(180deg, rgba(8,8,26,.9), rgba(8,8,22,.9));
      border-radius: calc(var(--radius2) + 4px);
      border:1px solid rgba(255,255,255,.16);
    }
    .mini .left{
      min-width:0;
    }
    .label{
      font-size: 12px;
      color: var(--muted2);
      margin-bottom: 6px;
    }
    .big{
      font-size: 16px;
      font-weight: 900;
      letter-spacing:.2px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .idea{
      color: rgba(255,255,255,.88);
      font-size: 13px;
      margin-top: 6px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .linksGrid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap: 12px;
      margin-top: 10px;
    }
    @media (max-width: 420px){
      .linksGrid{ grid-template-columns: 1fr; }
    }

    .linkCard{
      border:1px solid rgba(255,255,255,.16);
      background: radial-gradient(circle at 0 0, rgba(255,255,255,.12), rgba(7,7,25,.9));
      border-radius: 18px;
      padding: 13px;
      display:flex;
      align-items:center;
      gap: 10px;
      transition: transform .16s ease, border-color .16s ease, background .16s ease, box-shadow .16s ease;
      position:relative;
      overflow:hidden;
    }
    .linkCard::after{
      content:"";
      position:absolute;
      inset:0;
      background: radial-gradient(circle at 10% -10%, rgba(255,255,255,.35), transparent 55%);
      opacity:0;
      transition: opacity .25s ease;
      pointer-events:none;
      mix-blend-mode:screen;
    }
    .linkCard:hover{
      transform: translateY(-2px);
      border-color: rgba(255,255,255,.34);
      background: radial-gradient(circle at 0 0, rgba(255,255,255,.2), rgba(7,7,25,.95));
      box-shadow: 0 16px 40px rgba(0,0,0,.75);
    }
    .linkCard:hover::after{ opacity:.8; }

    .ico{
      width:28px; height:28px; border-radius: 10px;
      background: rgba(255,255,255,.12);
      border:1px solid rgba(255,255,255,.18);
      display:flex; align-items:center; justify-content:center;
      overflow:hidden;
      flex: 0 0 auto;
    }
    .ico img{ width:100%; height:100%; object-fit:cover; display:block; }
    .linkMeta{ min-width:0; }
    .linkMeta .t{
      font-weight: 850;
      font-size: 14px;
      margin:0;
      line-height: 1.2;
    }
    .linkMeta .d{
      margin:4px 0 0;
      font-size: 12px;
      color: var(--muted2);
      line-height: 1.3;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .form{
      display:grid;
      gap:10px;
      margin-top: 10px;
    }
    .field{
      width:100%;
      padding: 12px 12px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(5,5,26,.9);
      color: rgba(255,255,255,.96);
      outline:none;
      font-size: 14px;
      transition: border-color .16s ease, box-shadow .16s ease, background .16s ease;
    }
    .field::placeholder{ color: rgba(255,255,255,.45); }
    .field:focus{
      border-color: rgba(255,255,255,.4);
      box-shadow: 0 0 0 1px rgba(255,255,255,.2), 0 14px 36px rgba(0,0,0,.7);
      background: rgba(8,8,33,.98);
    }
    textarea.field{ min-height: 92px; resize: vertical; }

    .footer{
      margin-top:18px;
      text-align:center;
      color:var(--muted2);
      font-size:12px;
      opacity:.7;
    }

    /* bottom dock */
    .dock{
      position:fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: calc(16px + var(--safeB));
      width: min(980px, 92vw);
      z-index: 100;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.18);
      background: radial-gradient(circle at 0 0, rgba(255,255,255,.22), rgba(9,9,25,.96));
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
      box-shadow: 0 24px 90px rgba(0,0,0,.92);
      padding: 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      opacity:0;
      transform-origin: bottom;
      animation: dockEnter .7s cubic-bezier(.22,.8,.32,1) forwards;
      animation-delay:.38s;
    }

    @keyframes dockEnter{
      from{ opacity:0; transform: translateX(-50%) translateY(24px) scale(.96); }
      to{ opacity:1; transform: translateX(-50%) translateY(0) scale(1); }
    }

    .dockLeft{
      display:flex; align-items:center; gap:10px; min-width:0;
    }
    .track{
      min-width:0;
      display:flex;
      flex-direction:column;
      gap:4px;
    }
    .track .now{
      font-size: 12px;
      color: var(--muted2);
    }
    .track .name{
      font-size: 13px;
      font-weight: 800;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width: 46vw;
    }
    .bar{
      width: min(360px, 46vw);
      height: 7px;
      background: rgba(255,255,255,.1);
      border-radius: 999px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.16);
      position:relative;
    }
    .bar > i{
      display:block;
      height:100%;
      width:0%;
      background: linear-gradient(90deg, var(--a1), var(--a2), var(--a3));
      border-radius: 999px;
      box-shadow: 0 0 18px rgba(255,255,255,.6);
      transition: width .2s linear;
    }

    /* å°ç­‰åŒ–å™¨æ¡ï¼ˆéŸ³ä¹æ’­æ”¾æ—¶è·³åŠ¨ï¼‰ */
    .eq{
      display:flex;
      align-items:flex-end;
      gap:3px;
      margin-left:6px;
    }
    .eq span{
      width:3px;
      height:5px;
      border-radius:999px;
      background: linear-gradient(180deg, var(--a1), var(--a2));
      opacity:.4;
      transform-origin:bottom;
      transform: scaleY(.3);
      transition: transform .15s ease, opacity .15s ease;
    }

    .dockBtns{
      display:flex; gap:8px; align-items:center; flex: 0 0 auto;
    }
    .iconBtn{
      width: 44px; height: 44px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.2);
      background: radial-gradient(circle at 0 0, rgba(255,255,255,.18), rgba(7,7,28,.96));
      cursor:pointer;
      display:flex; align-items:center; justify-content:center;
      transition: transform .16s ease, border-color .16s ease, background .16s ease, box-shadow .16s ease;
    }
    .iconBtn:hover{
      transform: translateY(-1px);
      border-color: rgba(255,255,255,.36);
      background: radial-gradient(circle at 0 0, rgba(255,255,255,.3), rgba(7,7,28,.98));
      box-shadow: 0 14px 40px rgba(0,0,0,.8);
    }
    .iconBtn:active{ transform: translateY(0px) scale(.96); box-shadow:none; }
    .iconBtn svg{ width: 20px; height: 20px; fill: rgba(255,255,255,.9); }

    /* toast */
    .toast{
      position: fixed;
      left:50%;
      transform: translateX(-50%) translateY(-8px);
      top: calc(14px + var(--safeT));
      z-index: 200;
      padding: 9px 14px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(6,6,18,.85);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      color: rgba(255,255,255,.96);
      font-size: 13px;
      opacity:0;
      pointer-events:none;
      transition: opacity .22s ease, transform .22s ease;
      transform-origin: top center;
      box-shadow: 0 12px 36px rgba(0,0,0,.8);
    }
    .toast.show{
      opacity:1;
      transform: translateX(-50%) translateY(0);
    }

    /* click floating emoji */
    .floaty{
      position: fixed;
      z-index: 150;
      pointer-events:none;
      font-size: 18px;
      filter: drop-shadow(0 10px 20px rgba(0,0,0,.4));
      animation: floatUp 900ms ease-out forwards;
    }
    @keyframes floatUp{
      from{ transform: translate(-50%, -50%) translateY(0) scale(.9); opacity: .96; }
      to{ transform: translate(-50%, -50%) translateY(-64px) scale(1.16); opacity: 0; }
    }

    @media (prefers-reduced-motion: reduce){
      *{ animation:none !important; transition:none !important; }
    }
  </style>
</head>

<body data-mood="sweet">
  <!-- æ–°å¢ç‰¹æ•ˆå®¹å™¨ -->
  <div id="hearts-container"></div>
  <div id="audio-visualizer"></div>
  <div id="particles-js"></div>
  <div class="color-stream"></div>
  
  <div class="grain" aria-hidden="true"></div>
  <div class="gridlines" aria-hidden="true"></div>
  <div class="orb orb1" aria-hidden="true"></div>
  <div class="orb orb2" aria-hidden="true"></div>
  <div class="orb orb3" aria-hidden="true"></div>

  <div id="toast" class="toast" role="status" aria-live="polite"></div>

  <!-- éŸ³æ•ˆ + éŸ³ä¹ï¼ˆåŒç›®å½•æ”¾ mouseclick.mp3 ä¸ 1.mp3...11.mp3ï¼‰ -->
  <audio id="clickSound" src="mouseclick.mp3" preload="none"></audio>
  <audio id="bgMusic" preload="none"></audio>

  <div class="wrap">
    <header class="topbar">
      <div class="topbar-inner">
        <div class="brand" role="banner">
          <div class="avatar-wrap" aria-hidden="true">
            <div class="avatar-ring"></div>
            <div class="avatar">
              <img src="star.jpg" alt="" onerror="this.style.display='none';" />
            </div>
          </div>
          <div class="brand-title">
            <strong>DJCARL / æå¿ æ•</strong>
            <span>å¥½ç© Â· å¥½çœ‹ Â· å¥½å¬ Â· ä¼šä¸€ç‚¹æµªæ¼«</span>
          </div>
        </div>

        <div class="mood" aria-label="å¿ƒæƒ…ä¸»é¢˜">
          <button class="pill" id="moodSweet" aria-pressed="true" title="ç”œç”œçš„ç²‰è‰²å®‡å®™">ç”œ Â· Pink</button>
          <button class="pill" id="moodCool" aria-pressed="false" title="é…·ä¸€ç‚¹çš„ç´«è‰²å¤œ">é…· Â· Purple</button>
          <button class="pill" id="moodSoft" aria-pressed="false" title="æ¸©æŸ”ä¸€ç‚¹çš„è“ç»¿è‰²">æŸ” Â· Cyan</button>
        </div>
      </div>
    </header>

    <section class="grid" aria-label="ä¸»é¡µå†…å®¹">
      <!-- HERO -->
      <div class="card">
        <div class="inner">
          <div style="display:flex; align-items:center; gap:10px;">
            <span class="sparkle" aria-hidden="true"></span>
            <div style="color:var(--muted); font-size:13px;">æ¬¢è¿æ¥åˆ°æˆ‘çš„å°å®‡å®™</div>
          </div>

          <h1 class="h1">è®¤è¯†æˆ‘ï¼Œä¸ç”¨è¯»é•¿æ–‡ã€‚</h1>
          <p class="sub">
            æˆ‘æ›´å–œæ¬¢æŠŠ"ä»‹ç»"å˜æˆä¸€æ¬¡è½»æ¾çš„äº’åŠ¨ï¼šä½ ç‚¹ä¸€ä¸‹ï¼Œæˆ‘ä»¬å°±å¤šé è¿‘ä¸€å±‚ã€‚
          </p>

          <div class="chips" aria-label="å…´è¶£æ ‡ç­¾">
            <span class="chip">è¡—å¥ / å¥èº«</span>
            <span class="chip">Trance / é’¢ç´</span>
            <span class="chip">å“²å­¦ï¼ˆå„’é‡Šé“ï¼‰</span>
            <span class="chip">å›´æ£‹</span>
            <span class="chip">æ¸¸æˆï¼ˆä½†ä¸æ²‰è¿·ï¼‰</span>
            <span class="chip">ä¼šæŠ˜è…¾ä»»ä½•å¥½ç©çš„ä¸œè¥¿</span>
          </div>

          <div class="ctaRow">
            <button class="btn primary burst btn-glow" id="ideaBtn" type="button">
              <span aria-hidden="true">âœ¨</span> ç»™æˆ‘ä¸€ä¸ª"çº¦ä¼šçµæ„Ÿ"
            </button>
            <button class="btn ghost burst btn-glow" id="copyLineBtn" type="button" title="å¤åˆ¶ä¸€å¥å¥½å¼€åœº">
              <span aria-hidden="true">ğŸ’¬</span> å¤åˆ¶ä¸€å¥å¼€åœºç™½
            </button>
          </div>

          <div class="divider"></div>

          <div class="mini">
            <div class="left">
              <div class="label">ä»Šå¤©æˆ‘ä»¬å¯ä»¥ä¸€èµ·å»ï¼š</div>
              <div class="big" id="ideaTitle">å¤œå¸‚æ•£æ­¥ + å†°é¥®ï¼ˆä¸èµ¶æ—¶é—´ï¼‰</div>
              <div class="idea" id="ideaSub">å¦‚æœä½ æ›´å–œæ¬¢å®‰é™ï¼šæˆ‘ä»¬å»ä¹¦åº—/æµ·è¾¹/å…¬å›­ä¹Ÿè¡Œã€‚</div>
            </div>
            <button class="btn ghost burst btn-glow" id="surpriseBtn" type="button" title="å°å½©è›‹">
              <span aria-hidden="true">ğŸ</span> å½©è›‹
            </button>
          </div>
        </div>
      </div>

      <!-- RIGHT COLUMN -->
      <div style="display:grid; gap:16px;">
        <!-- LINKS -->
        <div class="card">
          <div class="inner">
            <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
              <div>
                <div style="font-weight:900; font-size:16px;">æˆ‘çš„é“¾æ¥</div>
                <div style="color:var(--muted2); font-size:12px; margin-top:4px;">ç‚¹è¿›å»å°±èƒ½æ‰¾åˆ°æˆ‘</div>
              </div>
              <div style="color:var(--muted2); font-size:12px;">åœ¨çº¿åç‰‡</div>
            </div>

            <div style="height:10px;"></div>

            <div class="linksGrid">
              <a class="linkCard" href="https://github.com/CARL-JOSEPH-LEE" target="_blank" rel="noopener noreferrer">
                <div class="ico"><img src="github.jpg" alt="GitHub" onerror="this.style.display='none';" /></div>
                <div class="linkMeta">
                  <p class="t">GitHub</p>
                  <p class="d">@CARL-JOSEPH-LEE</p>
                </div>
              </a>

              <a class="linkCard" href="https://twitter.com/CarlJosephLee1" target="_blank" rel="noopener noreferrer">
                <div class="ico"><img src="Twitter.jpg" alt="Twitter" onerror="this.style.display='none';" /></div>
                <div class="linkMeta">
                  <p class="t">Twitter</p>
                  <p class="d">@CarlJosephLee1</p>
                </div>
              </a>

              <a class="linkCard" href="https://www.luogu.com.cn/user/1230548" target="_blank" rel="noopener noreferrer">
                <div class="ico"><img src="lg.jpg" alt="æ´›è°·" onerror="this.style.display='none';" /></div>
                <div class="linkMeta">
                  <p class="t">æ´›è°·</p>
                  <p class="d">ç®—æ³• / åˆ·é¢˜</p>
                </div>
              </a>

              <a class="linkCard" href="https://youtube.com/@carljosephlee9537" target="_blank" rel="noopener noreferrer">
                <div class="ico"><img src="youtube.jpg" alt="YouTube" onerror="this.style.display='none';" /></div>
                <div class="linkMeta">
                  <p class="t">YouTube</p>
                  <p class="d">@carljosephlee9537</p>
                </div>
              </a>

              <a class="linkCard" href="https://ac.nowcoder.com/acm/contest/profile/473495180" target="_blank" rel="noopener noreferrer">
                <div class="ico"><img src="nowcoder.png" alt="ç‰›å®¢" onerror="this.style.display='none';" /></div>
                <div class="linkMeta">
                  <p class="t">ç‰›å®¢</p>
                  <p class="d">ç«èµ› / è®­ç»ƒ</p>
                </div>
              </a>

              <a class="linkCard" href="https://osu.ppy.sh/users/32702900/fruits" target="_blank" rel="noopener noreferrer">
                <div class="ico"><img src="osu.png" alt="osu" onerror="this.style.display='none';" /></div>
                <div class="linkMeta">
                  <p class="t">osu</p>
                  <p class="d">ç¡¬æ ¸éŸ³æ¸¸</p>
                </div>
              </a>
            </div>
          </div>
        </div>

        <!-- CONTACT -->
        <div class="card" id="contact">
          <div class="inner">
            <div style="font-weight:900; font-size:16px;">ç•™ä¸€å¥è¯</div>
            <div style="color:var(--muted2); font-size:12px; margin-top:6px;">
              å‘é€åŠŸèƒ½å·²é™çº§ï¼Œå› ä¸ºæˆ‘å‹æ ¹ä¸çœ‹åå°çš„æ¶ˆæ¯ï¼šï¼‰ã€‚
            </div>

            <form class="form" name="contact" method="POST" data-netlify="true" onsubmit="return validateForm()">
              <!-- Netlify needs this -->
              <input type="hidden" name="form-name" value="contact" />

              <input class="field" type="text" name="name" placeholder="ä½ çš„åå­—ï¼ˆæˆ–æ˜µç§°ï¼‰" aria-label="ä½ çš„åå­—"/>
              <input class="field" type="email" name="email" placeholder="é‚®ç®±ï¼ˆå¯é€‰ï¼Œä½†å»ºè®®ç•™ï¼‰" aria-label="é‚®ç®±"/>
              <textarea class="field" name="message" placeholder="ä¸€å¥å¼€åœºç™½ï¼šæ¯”å¦‚â€˜å‘¨æœ«æƒ³å–å’–å•¡å—ï¼Ÿâ€™" aria-label="æ¶ˆæ¯"></textarea>

              <button class="btn primary burst btn-glow" type="submit" style="width:100%; justify-content:center;">
                <span aria-hidden="true">ğŸ’Œ</span> å‘é€
              </button>

              <div style="color:var(--muted2); font-size:12px; line-height:1.4;">
                å°æç¤ºï¼šå¦‚æœä½ æ›´å–œæ¬¢"ç›´æ¥ä¸€ç‚¹"ï¼Œä¹Ÿå¯ä»¥å»ä¸Šé¢çš„å¹³å°ç§ä¿¡æˆ‘ã€‚
              </div>
            </form>
          </div>
        </div>
      </div>
    </section>

    <footer class="footer">
      Â© 2024â€“2025 DJCARL. ç¥ä½ æ¯å¤©éƒ½æœ‰ä¸€ç‚¹ç‚¹å¿ƒåŠ¨ã€‚
    </footer>
  </div>

  <!-- bottom dock: éŸ³ä¹ + ä¸‹ä¸€é¦– + æš—é»‘ + ç‰¹æ•ˆ(ç‚¹å‡»å°é£˜æµ®) -->
  <div class="dock" role="region" aria-label="å¿«æ·æ§åˆ¶">
    <div class="dockLeft">
      <div class="track">
        <div class="now" id="musicHint">éŸ³ä¹ï¼šç‚¹ â–¶ å¼€å§‹ï¼ˆéœ€è¦ä½ æ‰‹åŠ¨ç‚¹ä¸€ä¸‹ï¼‰</div>
        <div class="name" id="trackName">ç¬¬ 1 é¦–</div>
        <div class="bar" aria-hidden="true"><i id="progress"></i></div>
      </div>
      <div class="eq" aria-hidden="true">
        <span></span><span></span><span></span><span></span>
      </div>
    </div>

    <div class="dockBtns">
      <button class="iconBtn" id="musicToggle" type="button" title="æ’­æ”¾/æš‚åœ" aria-label="æ’­æ”¾/æš‚åœ">
        <!-- play icon (default) -->
        <svg id="iconPlay" viewBox="0 0 24 24" aria-hidden="true"><path d="M8 5v14l11-7z"/></svg>
        <svg id="iconPause" viewBox="0 0 24 24" aria-hidden="true" style="display:none;"><path d="M6 5h4v14H6zm8 0h4v14h-4z"/></svg>
      </button>

      <button class="iconBtn" id="nextTrack" type="button" title="ä¸‹ä¸€é¦–" aria-label="ä¸‹ä¸€é¦–">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M7 6v12l10-6zm10 0h2v12h-2z"/></svg>
      </button>

      <button class="iconBtn" id="darkModeToggle" type="button" title="æš—é»‘æ¨¡å¼" aria-label="æš—é»‘æ¨¡å¼">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 3a7.5 7.5 0 0 0 0 15 7.7 7.7 0 0 0 7-4.6A8.6 8.6 0 0 1 12 3z"/></svg>
      </button>
    </div>
  </div>

  <script>
    /***********************
     * æ–°å¢ç‰¹æ•ˆï¼šçˆ±å¿ƒèƒŒæ™¯
     ***********************/
    function createHearts() {
      const heartsContainer = document.getElementById('hearts-container');
      if (!heartsContainer) return;
      
      // åˆå§‹åˆ›å»ºä¸€äº›çˆ±å¿ƒ
      for (let i = 0; i < 15; i++) {
        setTimeout(() => createSingleHeart(), i * 300);
      }
      
      // å®šæœŸåˆ›å»ºæ–°çˆ±å¿ƒ
      setInterval(createSingleHeart, 2000);
    }
    
    function createSingleHeart() {
      const heartsContainer = document.getElementById('hearts-container');
      if (!heartsContainer) return;
      
      const heart = document.createElement('div');
      heart.className = 'floating-heart';
      heart.innerHTML = 'â¤ï¸';
      heart.style.left = Math.random() * 100 + '%';
      heart.style.color = getRandomColor();
      heart.style.fontSize = (Math.random() * 24 + 16) + 'px';
      heart.style.animationDuration = (Math.random() * 5 + 6) + 's';
      
      heartsContainer.appendChild(heart);
      
      // åŠ¨ç”»ç»“æŸåç§»é™¤å…ƒç´ 
      setTimeout(() => {
        if (heart.parentNode) {
          heart.parentNode.removeChild(heart);
        }
      }, 8000);
    }
    
    function getRandomColor() {
      const colors = ['#ff6fb1', '#ff9ac9', '#ffd3f0', '#c77dff', '#7c5cff', '#00e5ff', '#9ff3ff', '#61dafb', '#b9ffea'];
      return colors[Math.floor(Math.random() * colors.length)];
    }

    /***********************
     * æ–°å¢ç‰¹æ•ˆï¼šéŸ³é¢‘å¯è§†åŒ–
     ***********************/
    function initAudioVisualizer() {
      const visualizer = document.getElementById('audio-visualizer');
      if (!visualizer) return;
      
      // åˆ›å»ºéŸ³é¢‘å¯è§†åŒ–æ¡
      for (let i = 0; i < 64; i++) {
        const bar = document.createElement('div');
        bar.className = 'visualizer-bar';
        bar.style.left = (i / 64) * 100 + '%';
        bar.style.height = '10px';
        visualizer.appendChild(bar);
      }
      
      const bars = document.querySelectorAll('.visualizer-bar');
      
      // æ›´æ–°å¯è§†åŒ–æ•ˆæœ
      function updateVisualizer() {
        if (!bgMusic.paused) {
          visualizer.style.display = 'block';
          
          bars.forEach((bar, index) => {
            const height = 20 + Math.sin(Date.now() / 200 + index * 0.3) * 50 + Math.random() * 30;
            bar.style.height = height + 'px';
            bar.style.opacity = 0.3 + Math.abs(Math.sin(Date.now() / 500 + index * 0.2)) * 0.7;
            bar.style.background = `linear-gradient(to top, ${getComputedStyle(document.documentElement).getPropertyValue('--a1')}, ${getComputedStyle(document.documentElement).getPropertyValue('--a2')})`;
          });
        } else {
          visualizer.style.display = 'none';
        }
        
        requestAnimationFrame(updateVisualizer);
      }
      
      updateVisualizer();
    }

    /***********************
     * æ–°å¢ç‰¹æ•ˆï¼šæµæ˜Ÿé›¨
     ***********************/
    function createShootingStars() {
      setInterval(() => {
        if (Math.random() > 0.7) { // 30% æ¦‚ç‡ç”Ÿæˆæµæ˜Ÿ
          const star = document.createElement('div');
          star.className = 'shooting-star';
          
          // éšæœºèµ·å§‹ä½ç½®ï¼ˆä»ä¸Šæ–¹å‡ºç°ï¼‰
          const startX = Math.random() * window.innerWidth;
          const startY = -10;
          
          // éšæœºç»“æŸä½ç½®ï¼ˆæ–œå‘ç§»åŠ¨ï¼‰
          const endX = startX + (Math.random() * 200 - 100);
          const endY = window.innerHeight + 10;
          
          star.style.left = startX + 'px';
          star.style.top = startY + 'px';
          
          document.body.appendChild(star);
          
          // æµæ˜ŸåŠ¨ç”»
          star.animate([
            { 
              transform: `translate(0, 0)`,
              opacity: 0
            },
            { 
              transform: `translate(${endX - startX}px, ${endY - startY}px)`,
              opacity: 1
            },
            { 
              opacity: 0
            }
          ], {
            duration: 2000,
            easing: 'cubic-bezier(0.4, 0, 0.6, 1)'
          });
          
          // ç§»é™¤å…ƒç´ 
          setTimeout(() => {
            if (star.parentNode) {
              star.parentNode.removeChild(star);
            }
          }, 2000);
        }
      }, 3000);
    }

    /***********************
     * æ–°å¢ç‰¹æ•ˆï¼šé¼ æ ‡è·Ÿéšç²’å­
     ***********************/
    function initMouseParticles() {
      let mouseX = 0;
      let mouseY = 0;
      let trails = [];
      
      document.addEventListener('mousemove', (e) => {
        mouseX = e.clientX;
        mouseY = e.clientY;
        
        // åˆ›å»ºè·Ÿéšè½¨è¿¹
        if (Math.random() > 0.3) {
          const trail = document.createElement('div');
          trail.className = 'magic-trail';
          trail.style.left = mouseX + 'px';
          trail.style.top = mouseY + 'px';
          trail.style.background = `radial-gradient(circle, ${getComputedStyle(document.documentElement).getPropertyValue('--a1')}, transparent)`;
          
          document.body.appendChild(trail);
          trails.push(trail);
          
          // é™åˆ¶è½¨è¿¹æ•°é‡
          if (trails.length > 20) {
            const oldTrail = trails.shift();
            if (oldTrail.parentNode) {
              oldTrail.parentNode.removeChild(oldTrail);
            }
          }
          
          // æ·¡å‡ºå¹¶ç§»é™¤è½¨è¿¹
          setTimeout(() => {
            trail.style.opacity = '0';
            trail.style.transform = 'scale(0.5)';
            
            setTimeout(() => {
              if (trail.parentNode) {
                trail.parentNode.removeChild(trail);
                trails = trails.filter(t => t !== trail);
              }
            }, 300);
          }, 100);
        }
      });
      
      // ç‚¹å‡»æ—¶åˆ›å»ºç²’å­çˆ†ç‚¸
      document.addEventListener('click', (e) => {
        if (Math.random() > 0.5) {
          for (let i = 0; i < 8; i++) {
            setTimeout(() => {
              const particle = document.createElement('div');
              particle.className = 'magic-trail';
              particle.style.left = e.clientX + 'px';
              particle.style.top = e.clientY + 'px';
              particle.style.background = `radial-gradient(circle, ${getRandomColor()}, transparent)`;
              
              document.body.appendChild(particle);
              
              const angle = Math.random() * Math.PI * 2;
              const distance = 50 + Math.random() * 50;
              const targetX = Math.cos(angle) * distance;
              const targetY = Math.sin(angle) * distance;
              
              particle.animate([
                { transform: 'translate(0, 0) scale(1)', opacity: 1 },
                { transform: `translate(${targetX}px, ${targetY}px) scale(0)`, opacity: 0 }
              ], {
                duration: 800 + Math.random() * 400,
                easing: 'cubic-bezier(0.4, 0, 0.6, 1)'
              });
              
              setTimeout(() => {
                if (particle.parentNode) {
                  particle.parentNode.removeChild(particle);
                }
              }, 1200);
            }, i * 50);
          }
        }
      });
    }

    /***********************
     * æ–°å¢ç‰¹æ•ˆï¼šæŒ‰é’®è„‰å†²å…‰ç¯
     ***********************/
    function initButtonPulseEffects() {
      const buttons = document.querySelectorAll('.btn, .pill, .iconBtn');
      
      buttons.forEach(button => {
        button.addEventListener('mouseenter', () => {
          // åˆ›å»ºè„‰å†²å…‰ç¯
          const pulse = document.createElement('div');
          pulse.className = 'pulse-ring';
          pulse.style.borderColor = getComputedStyle(document.documentElement).getPropertyValue('--a1');
          pulse.style.width = button.offsetWidth + 20 + 'px';
          pulse.style.height = button.offsetHeight + 20 + 'px';
          pulse.style.left = '-10px';
          pulse.style.top = '-10px';
          
          button.style.position = 'relative';
          button.appendChild(pulse);
          
          // åŠ¨ç”»ç»“æŸåç§»é™¤
          setTimeout(() => {
            if (pulse.parentNode) {
              pulse.parentNode.removeChild(pulse);
            }
          }, 2000);
        });
      });
    }

    /***********************
     * æ–°å¢ç‰¹æ•ˆï¼šé¡µé¢åŠ è½½ç‚«å½©åŠ¨ç”»ï¼ˆåˆ é™¤å¡ç‰‡3Dæ•ˆæœéƒ¨åˆ†ï¼‰
     ***********************/
    function initPageEntranceEffects() {
      // æ ‡é¢˜éœ“è™¹æ•ˆæœ
      const title = document.querySelector('.h1');
      if (title) {
        setTimeout(() => {
          title.classList.add('neon-text');
        }, 1000);
        
        // å®šæœŸæ”¹å˜éœ“è™¹é¢œè‰²
        setInterval(() => {
          if (title.classList.contains('neon-text')) {
            title.style.color = getRandomColor();
          }
        }, 3000);
      }
      
      // åˆ é™¤å¡ç‰‡3Dæ•ˆæœéƒ¨åˆ†ï¼Œä¿æŒå¡ç‰‡åŸæœ‰ç»“æ„
    }

    /***********************
     * åˆå§‹åŒ–æ‰€æœ‰ç‰¹æ•ˆ
     ***********************/
    function initAllEffects() {
      createHearts();
      initAudioVisualizer();
      createShootingStars();
      initMouseParticles();
      initButtonPulseEffects();
      initPageEntranceEffects();
      
      // é¡µé¢åŠ è½½æ—¶çš„æ¬¢è¿ç‰¹æ•ˆ
      setTimeout(() => {
        for (let i = 0; i < 20; i++) {
          setTimeout(() => {
            const heart = document.createElement('div');
            heart.className = 'floating-heart';
            heart.innerHTML = 'âœ¨';
            heart.style.left = Math.random() * 100 + '%';
            heart.style.top = Math.random() * 100 + '%';
            heart.style.fontSize = (Math.random() * 30 + 20) + 'px';
            heart.style.animationDuration = '4s';
            
            document.getElementById('hearts-container').appendChild(heart);
            
            setTimeout(() => {
              if (heart.parentNode) {
                heart.parentNode.removeChild(heart);
              }
            }, 4000);
          }, i * 100);
        }
        
        toast('âœ¨ æ¬¢è¿æ¥åˆ°æˆ‘çš„ç‚«é…·å°å®‡å®™ï¼');
      }, 1500);
    }

    /***********************
     * åŸæœ‰ä»£ç ï¼ˆä¿æŒä¸å˜ï¼Œåªæ·»åŠ è°ƒç”¨æ–°ç‰¹æ•ˆï¼‰
     ***********************/
    const toastEl = document.getElementById('toast');
    let toastTimer = null;

    function toast(msg){
      if(!toastEl) return;
      toastEl.textContent = msg;
      toastEl.classList.add('show');
      clearTimeout(toastTimer);
      toastTimer = setTimeout(()=> toastEl.classList.remove('show'), 1700);
    }

    function floatyAt(x,y){
      const emojis = ["âœ¨","ğŸ’›","ğŸ«§","ğŸŒ™","ğŸ“","ğŸ§","â­","ğŸ¥¤"];
      const el = document.createElement('div');
      el.className = 'floaty';
      el.textContent = emojis[Math.floor(Math.random()*emojis.length)];
      el.style.left = x + 'px';
      el.style.top = y + 'px';
      document.body.appendChild(el);
      setTimeout(()=> el.remove(), 950);
    }

    /***********************
     * ç‚¹å‡»éŸ³æ•ˆ + æŒ‰é’®ç²’å­
     ***********************/
    const clickSound = document.getElementById('clickSound');
    function playClick(){
      if(!clickSound) return;
      try{
        clickSound.volume = 0.18;
        clickSound.currentTime = 0;
        const p = clickSound.play();
        if(p && typeof p.catch === "function") p.catch(()=>{});
      }catch(e){}
    }

    function spawnButtonParticles(btn, x, y){
      const rect = btn.getBoundingClientRect();
      const originX = x - rect.left;
      const originY = y - rect.top;
      const count = 10;
      for(let i=0;i<count;i++){
        const sp = document.createElement('span');
        sp.className = 'btn-particle';
        const angle = Math.random()*Math.PI*2;
        const dist = 26 + Math.random()*24;
        const dx = Math.cos(angle)*dist;
        const dy = Math.sin(angle)*dist;
        sp.style.left = originX + 'px';
        sp.style.top = originY + 'px';
        sp.style.setProperty('--dx', dx+'px');
        sp.style.setProperty('--dy', dy+'px');
        btn.appendChild(sp);
        setTimeout(()=> sp.remove(), 700);
      }
    }

    // ä»…å¯¹æŒ‰é’®/é“¾æ¥è§¦å‘éŸ³æ•ˆï¼ˆä¸å…¨å±ä¹±å“ï¼‰
    document.addEventListener('click', (e)=>{
      const t = e.target;
      const btn = t && t.closest('button');
      const link = t && t.closest('a');
      if(btn || link){
        playClick();
        floatyAt(e.clientX, e.clientY);
        if(btn && btn.classList.contains('burst')){
          spawnButtonParticles(btn, e.clientX, e.clientY);
        }
      }
    }, {passive:true});

    /***********************
     * ä¸»é¢˜å¿ƒæƒ…ï¼ˆç”œ/é…·/æŸ”ï¼‰+ è®°å¿†
     ***********************/
    const moodSweet = document.getElementById('moodSweet');
    const moodCool  = document.getElementById('moodCool');
    const moodSoft  = document.getElementById('moodSoft');

    function setMood(m){
      const root = document.documentElement;
      const body = document.body;

      if(m === 'cool'){
        // é…·ï¼šç´«è‰²è°ƒ + å†·è“ç‚¹ç¼€
        root.style.setProperty('--a1', '#c77dff');
        root.style.setProperty('--a2', '#7c5cff');
        root.style.setProperty('--a3', '#00e5ff');
      }else if(m === 'soft'){
        // æŸ”ï¼šè“ç»¿è‰²è°ƒ
        root.style.setProperty('--a1', '#9ff3ff');
        root.style.setProperty('--a2', '#61dafb');
        root.style.setProperty('--a3', '#b9ffea');
      }else{
        // ç”œï¼šç²‰è‰²è°ƒ
        root.style.setProperty('--a1', '#ff9ac9');
        root.style.setProperty('--a2', '#ff6fb1');
        root.style.setProperty('--a3', '#ffd3f0');
      }

      body.dataset.mood = m;

      const map = {sweet:moodSweet, cool:moodCool, soft:moodSoft};
      Object.keys(map).forEach(k => map[k].setAttribute('aria-pressed', String(k===m)));
      localStorage.setItem('mood', m);
      toast(m === 'cool' ? 'åˆ‡åˆ°ã€Œé…· Â· ç´«å¤œã€' : m === 'soft' ? 'åˆ‡åˆ°ã€ŒæŸ” Â· è“ç»¿ã€' : 'åˆ‡åˆ°ã€Œç”œ Â· ç²‰è‰²ã€');
      
      // åˆ‡æ¢ä¸»é¢˜æ—¶åˆ›å»ºä¸€äº›å¯¹åº”é¢œè‰²çš„çˆ±å¿ƒ
      for (let i = 0; i < 10; i++) {
        setTimeout(() => createSingleHeart(), i * 100);
      }
    }

    moodSweet?.addEventListener('click', ()=> setMood('sweet'));
    moodCool?.addEventListener('click',  ()=> setMood('cool'));
    moodSoft?.addEventListener('click',  ()=> setMood('soft'));

    const savedMood = localStorage.getItem('mood') || 'sweet';
    setMood(savedMood);

    /***********************
     * æš—é»‘æ¨¡å¼ï¼ˆåˆ‡æ¢ body.dark-modeï¼‰
     ***********************/
    const darkModeToggle = document.getElementById('darkModeToggle');
    const savedDark = localStorage.getItem('dark') === '1';
    if(savedDark) document.body.classList.add('dark-mode');

    darkModeToggle?.addEventListener('click', ()=>{
      document.body.classList.toggle('dark-mode');
      localStorage.setItem('dark', document.body.classList.contains('dark-mode') ? '1' : '0');
      toast(document.body.classList.contains('dark-mode') ? 'æš—é»‘æ¨¡å¼ï¼šå¼€' : 'æš—é»‘æ¨¡å¼ï¼šå…³');
      
      // åˆ‡æ¢æ¨¡å¼æ—¶åˆ›å»ºç‰¹æ•ˆ
      for (let i = 0; i < 15; i++) {
        setTimeout(() => {
          const star = document.createElement('div');
          star.className = 'floating-heart';
          star.innerHTML = document.body.classList.contains('dark-mode') ? 'ğŸŒ™' : 'â˜€ï¸';
          star.style.left = Math.random() * 100 + '%';
          star.style.top = Math.random() * 100 + '%';
          star.style.fontSize = (Math.random() * 24 + 16) + 'px';
          star.style.animationDuration = '3s';
          
          document.getElementById('hearts-container').appendChild(star);
          
          setTimeout(() => {
            if (star.parentNode) {
              star.parentNode.removeChild(star);
            }
          }, 3000);
        }, i * 50);
      }
    });

    /***********************
     * çº¦ä¼šçµæ„Ÿ & å¼€åœºç™½
     ***********************/
    const ideaTitle = document.getElementById('ideaTitle');
    const ideaSub   = document.getElementById('ideaSub');
    const ideaBtn   = document.getElementById('ideaBtn');
    const surpriseBtn = document.getElementById('surpriseBtn');
    const copyLineBtn = document.getElementById('copyLineBtn');

    const ideas = [
      ["å¤œå¸‚æ•£æ­¥ + å†°é¥®ï¼ˆä¸èµ¶æ—¶é—´ï¼‰", "è¾¹èµ°è¾¹èŠï¼Œèµ°ç´¯äº†å°±åä¸‹æ¥å¬æ­Œã€‚"],
      ["å’–å•¡é¦†åä¸€ä¼šå„¿", "ä½ ç‚¹ä½ å–œæ¬¢çš„ï¼Œæˆ‘è´Ÿè´£è®¤çœŸå¬ä½ è¯´è¯ã€‚"],
      ["ä¹¦åº— + éšæ‰‹æŒ‘ä¸€æœ¬ä¹¦", "ç¿»åˆ°å–œæ¬¢çš„å¥å­å°±å¿µç»™å¯¹æ–¹å¬ã€‚"],
      ["æµ·è¾¹ / å…¬å›­èµ°èµ°", "ä¸åšæ‰“å¡ï¼Œåªåšæ”¾æ¾ã€‚"],
      ["å°ä¼—å±•è§ˆ / åšç‰©é¦†", "çœ‹ä¸æ‡‚ä¹Ÿæ²¡å…³ç³»ï¼Œåæ§½ä¹Ÿå¾ˆå¯çˆ±ã€‚"],
      ["ä¸€å±€å›´æ£‹ï¼ˆè¾“çš„äººè¯·å¥¶èŒ¶ï¼‰", "èµ¢äº†ä½ ä¹Ÿå¯ä»¥ç»§ç»­æ¬ºè´Ÿæˆ‘ã€‚"],
      ["å¬æ­Œäº¤æ¢ï¼šä½ ä¸€é¦–æˆ‘ä¸€é¦–", "æˆ‘ä¼šè®¤çœŸæ”¶è—ä½ çš„æ­Œå•ã€‚"]
    ];

    const openers = [
      "æˆ‘æœ‰ä¸ªå°é—®é¢˜ï¼šä½ æ›´å–œæ¬¢æµ·è¾¹ã€ä¹¦åº—è¿˜æ˜¯å¤œå¸‚ï¼Ÿ",
      "å‘¨æœ«æƒ³ä¸æƒ³ä¸€èµ·èµ°èµ°ï¼Ÿæˆ‘å¸¦è·¯ï¼Œä½ å¸¦å¿ƒæƒ…ã€‚",
      "æˆ‘æƒ³æ”¶ä¸€é¦–ä½ çš„ç§è—æ­Œï¼šä½ æ„¿æ„åˆ†äº«å—ï¼Ÿ",
      "ä½ ä»Šå¤©å¿ƒæƒ…æ˜¯ä»€ä¹ˆé¢œè‰²ï¼Ÿæˆ‘æƒ³å¬ä½ è®²ã€‚",
      "å¦‚æœæˆ‘ä»¬å»å–å’–å•¡ï¼Œä½ ä¼šç‚¹ç”œçš„è¿˜æ˜¯è‹¦çš„ï¼Ÿ"
    ];

    function rollIdea(){
      const it = ideas[Math.floor(Math.random()*ideas.length)];
      ideaTitle.textContent = it[0];
      ideaSub.textContent = it[1];
      
      // æ·»åŠ ç‰¹æ•ˆ
      for (let i = 0; i < 8; i++) {
        setTimeout(() => {
          const heart = document.createElement('div');
          heart.className = 'floating-heart';
          heart.innerHTML = 'ğŸ’¡';
          heart.style.left = (Math.random() * 50 + 25) + '%';
          heart.style.top = (Math.random() * 30 + 35) + '%';
          heart.style.fontSize = (Math.random() * 20 + 16) + 'px';
          heart.style.animationDuration = '2s';
          
          document.getElementById('hearts-container').appendChild(heart);
          
          setTimeout(() => {
            if (heart.parentNode) {
              heart.parentNode.removeChild(heart);
            }
          }, 2000);
        }, i * 100);
      }
    }
    ideaBtn?.addEventListener('click', rollIdea);

    surpriseBtn?.addEventListener('click', ()=>{
      toast("å½©è›‹ï¼šå¯¹ç€å±å¹•ç‚¹ä¸‰ä¸‹ï¼Œä¼šæ‰å°æ˜Ÿæ˜Ÿ âœ¨");
      
      // åˆ›å»ºå½©è›‹ç‰¹æ•ˆ
      for (let i = 0; i < 15; i++) {
        setTimeout(() => {
          const gift = document.createElement('div');
          gift.className = 'floating-heart';
          gift.innerHTML = 'ğŸ';
          gift.style.left = Math.random() * 100 + '%';
          gift.style.top = Math.random() * 100 + '%';
          gift.style.fontSize = (Math.random() * 30 + 20) + 'px';
          gift.style.animationDuration = '3s';
          
          document.getElementById('hearts-container').appendChild(gift);
          
          setTimeout(() => {
            if (gift.parentNode) {
              gift.parentNode.removeChild(gift);
            }
          }, 3000);
        }, i * 150);
      }
    });

    let triple = {t:0, n:0};
    document.addEventListener('pointerdown', (e)=>{
      const now = Date.now();
      if(now - triple.t > 500){ triple.n = 0; }
      triple.t = now;
      triple.n += 1;
      if(triple.n >= 3){
        triple.n = 0;
        for(let i=0;i<8;i++){
          setTimeout(()=>{
            floatyAt(
              Math.max(12, Math.min(window.innerWidth-12, e.clientX + (Math.random()*80-40))),
              Math.max(12, Math.min(window.innerHeight-12, e.clientY + (Math.random()*80-40)))
            );
          }, i*35);
        }
        toast("âœ¨ å°æ˜Ÿæ˜Ÿå·²æŠ•æ”¾");
        
        // é¢å¤–æ·»åŠ æµæ˜Ÿé›¨
        for (let i = 0; i < 5; i++) {
          setTimeout(() => {
            const star = document.createElement('div');
            star.className = 'shooting-star';
            star.style.left = e.clientX + 'px';
            star.style.top = e.clientY + 'px';
            
            document.body.appendChild(star);
            
            star.animate([
              { 
                transform: `translate(0, 0)`,
                opacity: 0
              },
              { 
                transform: `translate(${Math.random()*200-100}px, ${window.innerHeight}px)`,
                opacity: 1
              },
              { 
                opacity: 0
              }
            ], {
              duration: 1500,
              easing: 'cubic-bezier(0.4, 0, 0.6, 1)'
            });
            
            setTimeout(() => {
              if (star.parentNode) {
                star.parentNode.removeChild(star);
              }
            }, 1500);
          }, i * 200);
        }
      }
    }, {passive:true});

    copyLineBtn?.addEventListener('click', async ()=>{
      const line = openers[Math.floor(Math.random()*openers.length)];
      try{
        await navigator.clipboard.writeText(line);
        toast("å¼€åœºç™½å·²å¤åˆ¶ï¼šå»å‘ç»™æˆ‘å§");
        
        // å¤åˆ¶æˆåŠŸç‰¹æ•ˆ
        for (let i = 0; i < 5; i++) {
          setTimeout(() => {
            const bubble = document.createElement('div');
            bubble.className = 'floating-heart';
            bubble.innerHTML = 'ğŸ’¬';
            const btnRect = copyLineBtn.getBoundingClientRect();
            bubble.style.left = btnRect.left + btnRect.width/2 + 'px';
            bubble.style.top = btnRect.top + 'px';
            bubble.style.fontSize = '20px';
            bubble.style.animationDuration = '1.5s';
            
            document.getElementById('hearts-container').appendChild(bubble);
            
            setTimeout(() => {
              if (bubble.parentNode) {
                bubble.parentNode.removeChild(bubble);
              }
            }, 1500);
          }, i * 200);
        }
      }catch(_){
        // fallback
        const ta = document.createElement('textarea');
        ta.value = line;
        document.body.appendChild(ta);
        ta.select();
        try{
          document.execCommand('copy');
          toast("å¼€åœºç™½å·²å¤åˆ¶ï¼šå»å‘ç»™æˆ‘å§");
        }catch(e){
          toast("å¤åˆ¶å¤±è´¥ï¼šæ‰‹åŠ¨å¤åˆ¶ä¹Ÿå¾ˆé…·");
        }
        ta.remove();
      }
    });

    /***********************
     * è¡¨å•æ ¡éªŒ
     ***********************/
    function validateForm() {
      const f = document.forms["contact"];
      const name = (f["name"].value || "").trim();
      const email = (f["email"].value || "").trim();
      const message = (f["message"].value || "").trim();
      if (name === "" || email === "" || message === "") {
        alert("æŠŠä¸‰é¡¹éƒ½å†™ä¸€ä¸‹å˜›ï½ï¼ˆåå­— / é‚®ç®± / ä¸€å¥è¯ï¼‰");
        return false;
      }
      toast("å·²æäº¤ï¼ˆå¦‚æœä½ ç”¨ Netlifyï¼Œä¼šæ”¶åˆ°æ¶ˆæ¯ï¼‰");
      
      // è¡¨å•æäº¤ç‰¹æ•ˆ
      const submitBtn = f.querySelector('button[type="submit"]');
      if (submitBtn) {
        for (let i = 0; i < 10; i++) {
          setTimeout(() => {
            const heart = document.createElement('div');
            heart.className = 'floating-heart';
            heart.innerHTML = 'ğŸ’Œ';
            const btnRect = submitBtn.getBoundingClientRect();
            heart.style.left = btnRect.left + btnRect.width/2 + 'px';
            heart.style.top = btnRect.top + 'px';
            heart.style.fontSize = (Math.random() * 20 + 16) + 'px';
            heart.style.animationDuration = '2s';
            
            document.getElementById('hearts-container').appendChild(heart);
            
            setTimeout(() => {
              if (heart.parentNode) {
                heart.parentNode.removeChild(heart);
              }
            }, 2000);
          }, i * 100);
        }
      }
      
      return true;
    }
    window.validateForm = validateForm;

    /***********************
     * éŸ³ä¹æ’­æ”¾å™¨ï¼ˆ1.mp3..11.mp3 è½®æ’­ï¼‰
     ***********************/
    const bgMusic = document.getElementById('bgMusic');
    const musicToggle = document.getElementById('musicToggle');
    const nextTrack = document.getElementById('nextTrack');
    const trackName = document.getElementById('trackName');
    const musicHint = document.getElementById('musicHint');
    const progress = document.getElementById('progress');
    const iconPlay = document.getElementById('iconPlay');
    const iconPause = document.getElementById('iconPause');
    const eqBars = document.querySelectorAll('.eq span');

    let currentTrackIndex = Number(localStorage.getItem('trackIndex') || '1');
    const totalTracks = 11;
    let eqTimer = null;

    function setTrack(i, autoplay=false){
      currentTrackIndex = i;
      if(currentTrackIndex > totalTracks) currentTrackIndex = 1;
      if(currentTrackIndex < 1) currentTrackIndex = totalTracks;
      localStorage.setItem('trackIndex', String(currentTrackIndex));

      bgMusic.src = `${currentTrackIndex}.mp3`;
      trackName.textContent = `ç¬¬ ${currentTrackIndex} é¦–`;
      musicHint.textContent = autoplay ? "éŸ³ä¹ï¼šæ­£åœ¨æ’­æ”¾" : "éŸ³ä¹ï¼šå·²å°±ç»ªï¼ˆç‚¹ â–¶ æ’­æ”¾ï¼‰";

      if(autoplay){
        safePlay();
      }else{
        bgMusic.pause();
        setPlayIcon(false);
        stopEq();
      }
    }

    function setPlayIcon(isPlaying){
      if(!iconPlay || !iconPause) return;
      iconPlay.style.display = isPlaying ? "none" : "block";
      iconPause.style.display = isPlaying ? "block" : "none";
    }

    function startEq(){
      stopEq();
      eqTimer = setInterval(()=>{
        eqBars.forEach((bar, idx)=>{
          const factor = 0.3 + Math.random()*0.9;
          bar.style.transform = `scaleY(${factor})`;
          bar.style.opacity = 0.3 + factor*0.4;
        });
      }, 140);
    }

    function stopEq(){
      if(eqTimer) clearInterval(eqTimer);
      eqTimer = null;
      eqBars.forEach(bar=>{
        bar.style.transform = 'scaleY(0.3)';
        bar.style.opacity = '.4';
      });
    }

    async function safePlay(){
      try{
        bgMusic.volume = 0.85;
        const p = bgMusic.play();
        if(p && typeof p.then === "function"){
          await p;
        }
        setPlayIcon(true);
        musicHint.textContent = "éŸ³ä¹ï¼šæ­£åœ¨æ’­æ”¾";
        startEq();
        
        // éŸ³ä¹æ’­æ”¾ç‰¹æ•ˆ
        for (let i = 0; i < 10; i++) {
          setTimeout(() => {
            const note = document.createElement('div');
            note.className = 'floating-heart';
            note.innerHTML = 'ğŸµ';
            const btnRect = musicToggle.getBoundingClientRect();
            note.style.left = btnRect.left + btnRect.width/2 + 'px';
            note.style.top = btnRect.top + 'px';
            note.style.fontSize = (Math.random() * 24 + 16) + 'px';
            note.style.animationDuration = '2s';
            
            document.getElementById('hearts-container').appendChild(note);
            
            setTimeout(() => {
              if (note.parentNode) {
                note.parentNode.removeChild(note);
              }
            }, 2000);
          }, i * 150);
        }
      }catch(e){
        setPlayIcon(false);
        stopEq();
        toast("æ’­æ”¾å¤±è´¥ï¼šè¯·ç¡®è®¤åŒç›®å½•æœ‰ mp3ï¼Œä¸”å…ˆç‚¹ä¸€ä¸‹æ’­æ”¾é”®");
      }
    }

    function next(){
      setTrack(currentTrackIndex + 1, true);
      toast("ä¸‹ä¸€é¦– ğŸ§");
      
      // åˆ‡æ­Œç‰¹æ•ˆ
      for (let i = 0; i < 8; i++) {
        setTimeout(() => {
          const note = document.createElement('div');
          note.className = 'floating-heart';
          note.innerHTML = 'ğŸ¶';
          const btnRect = nextTrack.getBoundingClientRect();
          note.style.left = btnRect.left + btnRect.width/2 + 'px';
          note.style.top = btnRect.top + 'px';
          note.style.fontSize = (Math.random() * 20 + 16) + 'px';
          note.style.animationDuration = '1.5s';
          
          document.getElementById('hearts-container').appendChild(note);
          
          setTimeout(() => {
            if (note.parentNode) {
              note.parentNode.removeChild(note);
            }
          }, 1500);
        }, i * 100);
      }
    }

    // init
    setTrack(currentTrackIndex, false);

    musicToggle?.addEventListener('click', async ()=>{
      if(bgMusic.paused){
        await safePlay();
      }else{
        bgMusic.pause();
        setPlayIcon(false);
        stopEq();
        musicHint.textContent = "éŸ³ä¹ï¼šå·²æš‚åœ";
      }
    });

    nextTrack?.addEventListener('click', next);

    bgMusic.addEventListener('ended', ()=>{
      // è‡ªåŠ¨ä¸‹ä¸€é¦–
      setTrack(currentTrackIndex + 1, true);
    });

    bgMusic.addEventListener('timeupdate', ()=>{
      if(!bgMusic.duration || !isFinite(bgMusic.duration)) return;
      const pct = Math.max(0, Math.min(1, bgMusic.currentTime / bgMusic.duration));
      progress.style.width = (pct * 100).toFixed(2) + '%';
    });

    bgMusic.addEventListener('error', ()=>{
      toast("æ²¡æ‰¾åˆ°éŸ³é¢‘æ–‡ä»¶ï¼šè¯·ç¡®è®¤ 1.mp3...11.mp3 åœ¨åŒç›®å½•");
    });

    /***********************
     * å¡ç‰‡æ»šåŠ¨ revealï¼ˆä¿ç•™ï¼‰
     ***********************/
    const cards = document.querySelectorAll('.card');
    const observer = new IntersectionObserver((entries)=>{
      entries.forEach(entry=>{
        if(entry.isIntersecting){
          entry.target.classList.add('reveal-show');
          
          // å¡ç‰‡å‡ºç°æ—¶æ·»åŠ ç‰¹æ•ˆ
          if (!entry.target.hasAttribute('data-animated')) {
            entry.target.setAttribute('data-animated', 'true');
            
            for (let i = 0; i < 5; i++) {
              setTimeout(() => {
                const spark = document.createElement('div');
                spark.className = 'floating-heart';
                spark.innerHTML = 'âœ¨';
                const rect = entry.target.getBoundingClientRect();
                spark.style.left = rect.left + Math.random() * rect.width + 'px';
                spark.style.top = rect.top + Math.random() * rect.height + 'px';
                spark.style.fontSize = (Math.random() * 16 + 12) + 'px';
                spark.style.animationDuration = '1s';
                
                document.getElementById('hearts-container').appendChild(spark);
                
                setTimeout(() => {
                  if (spark.parentNode) {
                    spark.parentNode.removeChild(spark);
                  }
                }, 1000);
              }, i * 100);
            }
          }
          
          observer.unobserve(entry.target);
        }
      });
    },{ threshold:0.18 });

    cards.forEach(c=> observer.observe(c));

    /***********************
     * é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–æ‰€æœ‰ç‰¹æ•ˆ
     ***********************/
    window.addEventListener('DOMContentLoaded', () => {
      setTimeout(() => {
        initAllEffects();
      }, 500);
    });
  </script>
</body>
</html>